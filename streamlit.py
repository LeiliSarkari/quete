# -*- coding: utf-8 -*-
"""streamlit.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZoOcxAgPdid33GFs7TKwZ1RVlqjYWSdK
"""

import streamlit as st
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import plotly.express as px

# Charger les données
url = 'https://raw.githubusercontent.com/murpi/wilddata/master/quests/cars.csv'
df = pd.read_csv(url)

# Afficher les colonnes disponibles
st.write("Colonnes disponibles dans le DataFrame:")
st.write(df.columns)

# Demander à l'utilisateur de choisir une région (remplacez 'Region' par le nom correct si nécessaire)
region = st.selectbox('Sélectionnez une région:', df['Region'].unique())

# Vérifier si la colonne 'Region' existe
if 'Region' in df.columns:
    # Filtrer les données en fonction de la région
    df_filtered = df[df['Region'] == region]

    # Analyse de corrélation
    st.subheader('Matrice de Corrélation')
    corr = df_filtered.corr()
    fig_corr, ax_corr = plt.subplots(figsize=(10, 8))
    sns.heatmap(corr, annot=True, cmap='coolwarm', fmt='.2f', ax=ax_corr)
    st.pyplot(fig_corr)

    # Analyse de distribution
    st.subheader('Distribution des Prix des Voitures')
    fig_dist, ax_dist = plt.subplots(figsize=(10, 6))
    sns.histplot(df_filtered['Price'].dropna(), bins=30, kde=True, ax=ax_dist)
    ax_dist.set_title('Distribution des Prix')
    ax_dist.set_xlabel('Prix')
    ax_dist.set_ylabel('Fréquence')
    st.pyplot(fig_dist)

    # Graphique interactif avec Plotly
    st.subheader('Graphique Interactif des Prix vs. Kilométrage')
    fig_plotly = px.scatter(df_filtered, x='Price', y='Mileage', color='Region',
                           title=f'Distribution des Prix vs. Kilométrage ({region})',
                           labels={'Price': 'Prix', 'Mileage': 'Kilométrage'})
    st.plotly_chart(fig_plotly)
else:
    st.error("La colonne 'Region' n'existe pas dans le DataFrame. Vérifiez le nom des colonnes.")
